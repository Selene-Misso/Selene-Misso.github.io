---
layout: post
title: 資格試験用の座席表とラベルを自動生成するプログラムを作った
---


年に5,6回ある某大手英語資格の学内版があり，
大学生協が大学に代わり運営している．
大学から学生のデータを貰い，
学生に教室と座席を割り当てて，
座席表と机に学生番号を貼るラベルを作成する．

この座席表とラベルの作成が，手作業で
ひたすらミスしないようにコピペする，
という大変面倒くさいものだった．
私もバイトの身で関わりかれこれ３年ほどやったが，
時間はかかるし，
単純作業だし，
ミスは許さないので２重チェックやったりと
随分つらい思いをした．

自動化するとだいぶ楽になるんじゃないかと思い，
座席表とラベルを自動生成するプログラムを作成した．
本日無事に生協に渡してきた．
作成時間は38時間ほど．

## 技術的な話

システム全体の入力は，
教室を割り当て済みの学生データ．
出力は各教室の座席表とラベルである．

手頃なUIがあり，マルチプラットフォームなプラットフォームで開発したいという希望があった．
ぴったりだと思って選んだのが，
node webkit．
これだと
マルチプラットフォームで，
かつHTMLとCSSでUIを書ける．
そして
node.jsの勉強ができる．

というわけで node webkit で開発することにした．

座席表とラベルは，
HTMLとCSSで組むことにした．
要は学生の文字列を差し込めればいいので，
Office以外で組版できるものと考えると，
これしかないと思う．
幸い，最近
http://qiita.com/cognitom/items/d39d5f19054c8c8fd592
のようなことが出来るようになっているので活用した．
CSSのミリ単位の指定が結構正確だった．
あとはborderがときとき描画しないことがあり，
苦労した．原因は分からないが
回避策で解決した．


nodeでプログラムを作成するのは初めてだったが，
DOMとJQueryの知識でなんとかなった．
厄介だったのは非同期のファイル操作を
意識せずに書いちゃうこと．
同期のファイル操作の書き方が，
はっきり分からなかったので苦労した．


マルチプラットフォームのUIつきな言語としては，
nodeはなかなかいいと思う．
欲を言えばpythonのほうが良かったなぁと思う．


このシステムによって，作業時間が３時間から３０秒に
短縮できると思う．
